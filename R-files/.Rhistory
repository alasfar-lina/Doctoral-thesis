theme(axis.line.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.grid.minor.x=element_blank(),
panel.grid.major.x=element_blank())
decorate_annotation("gplot", {
vp = current.viewport()$name
print(pltfunc , vp = vp)
})
pltfunc<- ggplot(df, aes(x = index, y = mean)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower_bound, ymax = upper_bound))+
theme(axis.line.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.grid.minor.x=element_blank(),
panel.grid.major.x=element_blank())
decorate_annotation("gplot", {
vp = current.viewport()$name
print(pltfunc , vp = vp)
})
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
ord<-column_order(ht)
ord
keyDF <- data.frame(key=ord,weight=1:length(ord))
df
merged <- merge(df,keyDF,by.x='index',by.y='key',all.x=T,all.y=F)
res <- merged[order(merged$weight),c('operators','upper_bound','lower_bound')]
pltfunc<- ggplot(df, aes(x = index, y = mean)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower_bound, ymax = upper_bound))+
theme(axis.line.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.grid.minor.x=element_blank(),
panel.grid.major.x=element_blank())
decorate_annotation("gplot", {
vp = current.viewport()$name
print(pltfunc , vp = vp)
})
print(pltfunc+theme_void , vp = vp)
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
ord<-column_order(ht)
ord
keyDF <- data.frame(key=ord,weight=1:length(ord))
df
merged <- merge(df,keyDF,by.x='index',by.y='key',all.x=T,all.y=F)
res <- merged[order(merged$weight),c('operators','upper_bound','lower_bound')]
pltfunc<- ggplot(df, aes(x = index, y = mean)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower_bound, ymax = upper_bound))+
theme(axis.line.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
panel.grid.minor.x=element_blank(),
panel.grid.major.x=element_blank())
decorate_annotation("gplot", {
vp = current.viewport()$name
print(pltfunc+theme_void() , vp = vp)
})
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
ord<-column_order(ht)
ord
keyDF <- data.frame(key=ord,weight=1:length(ord))
df
merged <- merge(df,keyDF,by.x='index',by.y='key',all.x=T,all.y=F)
res <- merged[order(merged$weight),c('operators','upper_bound','lower_bound')]
pltfunc<- ggplot(df, aes(x = index, y = mean)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower_bound, ymax = upper_bound)) #+
#  theme(axis.line.x=element_blank(),
#       axis.text.x=element_blank(),
#      axis.ticks.x=element_blank(),
#     axis.title.x=element_blank(),
#    axis.title.y=element_blank(),
#   panel.grid.minor.x=element_blank(),
#  panel.grid.major.x=element_blank())
decorate_annotation("gplot", {
vp = current.viewport()$name
print(pltfunc+theme_void() , vp = vp)
})
grid.rect(y = 1, height = 1, default.units = "native")
ht<- Heatmap(matr,show_column_dend = FALSE)
ht <- draw(ht)
ord<-column_order(ht)
ord
keyDF <- data.frame(key=ord,weight=1:length(ord))
df
merged <- merge(df,keyDF,by.x='index',by.y='key',all.x=T,all.y=F)
res <- merged[order(merged$weight),c('operators','upper_bound','lower_bound')]
pltfunc<- ggplot(df, aes(x = index, y = mean)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower_bound, ymax = upper_bound)) #+
#  theme(axis.line.x=element_blank(),
#       axis.text.x=element_blank(),
#      axis.ticks.x=element_blank(),
#     axis.title.x=element_blank(),
#    axis.title.y=element_blank(),
#   panel.grid.minor.x=element_blank(),
#  panel.grid.major.x=element_blank())
ha = HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45
)
pltfunc<-function(){ ggplot(df, aes(x = index, y = mean)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower_bound, ymax = upper_bound)) #+
#  theme(axis.line.x=element_blank(),
#       axis.text.x=element_blank(),
#      axis.ticks.x=element_blank(),
#     axis.title.x=element_blank(),
#    axis.title.y=element_blank(),
#   panel.grid.minor.x=element_blank(),
#  panel.grid.major.x=element_blank())
}
ha = HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45
)
ht=ht+colAnnotation(ha)
ht=ht+top_Annotation(ha)
ht=ht+annotation_col(ha)
ht=ht+top_annotation(ha)
ht=ht+HeatmapAnnotation(ha)
HeatmapAnnotation?
?HeatmapAnnotation
help(HeatmapAnnotation)
ht=ht+ha
ht
ht+rowAnnotation(ha)
ha = HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45
)
ht+rowAnnotation(ha)
ht<- ht+ HeatmapAnnotation(foo = df$classification,
ht<- ht+ HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45)
ht<- ht+ HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45)
ht<- ht+ HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc(),
annotation_name_rot = 45)
ht<- ht+ HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45)
ht<- ht+ HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45
which = colum)
ht<- ht+ HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45,
which = column)
ht<- ht+ HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45,
which = 1)
ht<- ht+ HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45,
which = row)
ht<- ht+ HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45,
which = row)
help(HeatmapAnnotation)
ht<- ht+ HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45,
which = "column")
ht<- ht+ HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45,
which = "row")
ht<- ht+ HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45,
which = "row")
pltfunc<-function(){ ggplot(df, aes(x = index, y = mean)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower_bound, ymax = upper_bound)) #+
#  theme(axis.line.x=element_blank(),
#       axis.text.x=element_blank(),
#      axis.ticks.x=element_blank(),
#     axis.title.x=element_blank(),
#    axis.title.y=element_blank(),
#   panel.grid.minor.x=element_blank(),
#  panel.grid.major.x=element_blank())
}
ha<- HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45)
ht<- Heatmap(matr,show_column_dend = FALSE,op_annotation = ha)
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
ord<-column_order(ht)
pltfunc<-function(index){ ggplot(df, aes(x = index, y = mean)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower_bound, ymax = upper_bound)) #+
#  theme(axis.line.x=element_blank(),
#       axis.text.x=element_blank(),
#      axis.ticks.x=element_blank(),
#     axis.title.x=element_blank(),
#    axis.title.y=element_blank(),
#   panel.grid.minor.x=element_blank(),
#  panel.grid.major.x=element_blank())
}
ha<- HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
gplot = pltfunc,
annotation_name_rot = 45)
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
ht <- draw(ht)
ord<-column_order(ht)
ha<- HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
#gplot = pltfunc,
annotation_name_rot = 45)
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
library('ComplexHeatmap')
library(tidyr)
library(dplyr)
library(reshape2)
library(ggplot2)
zstar= 1.69
df = data.frame(
'index'=c(1:33),
'upper_bound'=c(2.019,5.834,1.862,3.346,1.025,0.393,0.271,0.347,0.293,0.638,0.371,
0.107,0.029,0.094,
2.195,-0.458,0.229,
0.348,0.035,0.370,0.040,0.344,0.062,
0.687,0.062,0.343,
0.005,0.002,0.007,0.0025,0.0015,0.5150,5.3
),
'lower_bound'=c(-2.229,-6.812,-1.830,-4.213,-1.151,-0.483,-0.205,-0.911,-0.380,-1.308,-0.449,
0.006,-0.084,-0.044,
-3.028,0.375,-0.187,
-1.286,-0.007,-0.004,-0.027,-0.375,-0.432,
-0.562,-0.432,-0.281,
-0.002,-0.005,-0.016,-0.005,-0.0253,-0.4390,-8.0
),
'operators'= c('cQQ1','cQQ8','cQt1','cQt8','ctt1','c8qt','c1qt','c8ut','c1ut','c8dt','c1dt',
'ctG','ctW','ctZ',
'cpt','cpui','cpdi',
'ctp','cbp','ccp','ctap','c3pQ3','c3pq',
'cpei','c3pli','cpli'
,'cpG','cpB','cpW','cpWB','cpD','cpBox','cp'),
'muttH'=c(0.,0.,0.,+13290.1/10^6,+137479./10^6,152635/10^6,22531.7/10^6,34359.2/10^6,34359.2/10^6,-1123.41/10^6,+15070.6/10^6,
+568696/10^6,0,0,
0,0,0,
0,0,0,0,0,0,
0,0,0,
+423765./10^6,0,0,0,0,0,0),
'muWH'=c(0.,0.,0.,0,0,0,0,0,0,0,0,
0,0,0,
0,0,0,
0,0,0,0,0,0,
0,0,0,
0,0,1095782/10^6, -285105./10^6,-160282/10^6,121150/10^6,0),
'muZH'=c(0.,0.,0.,0,0,0,0,0,0,0,0,
0,0,0,
0,0,0,
+484275./10^6,-197878./10^6,+484275./10^6,0,2175601/10^6,90.68/10^6,
0,0,0,
0,+91707.3/10^6,+741805./10^6, +215319/10^6,-14992.4/10^6,121269/10^6,0),
'muVBF'=c(0.,0.,0.,0,0,0,0,0,0,0,0,
0,0,0,
0,0,0,
0,0, -629.4/10^6,0, -16751.6/10^6,-15060.5/10^6,
0,0,0,
+57783.8/10^6, +5770.95 /10^6,  -51626.2/10^6,+21988.3/10^6,-170868./10^6,+121321./10^6,0),
'muggHH'=c(0.,0.,0.,0,0,0,0,0,0,0,0,
0,0,0,
0.317493,0,0,
0,0,0,0,0,0,
0,0,0,
-0.152591,0,0,0,0.208482/4,-0.208482,0.491977),
'muggH'=c(0.,0.,0.,0,0,0,0,0,0,0,0,
0,0,0,
0,0,0,
0,0,0,0,0,0,
0,0,0,
0,0,0,0,0,0,0),
'sigmattZ'=c(0.,0.,0.,0,0,0,0,0,0,0,0,
0,0,0,
0,0,0,
0,0,0,0,0,0,
0,0,0,
0,0,0,0,0,0,0),
'sigmattW:'=c(0.,0.,0.,0,0,0,0,0,0,0,0,
0,0,0,
0,0,0,
0,0,0,0,0,0,
0,0,0,
0,0,0,0,0,0,0),
'sigmattA'=c(0.,0.,0.,0,0,0,0,0,0,0,0,
0,0,0,
0,0,0,
0,0,0,0,0,0,
0,0,0,
0,0,0,0,0,0,0),
'sigmatqZ'=c(0.,0.,0.,0,0,0,0,0,0,0,0,
0,0,0,
0,0,0,
0,0,0,0,0,0,
0,0,0,
0,0,0,0,0,0,0),
'sigmatW'=c(0.,0.,0.,0,0,0,0,0,0,0,0,
0,0,0,
0,0,0,
0,0,0,0,0,0,
0,0,0,
0,0,0,0,0,0,0),
'sigmatq'=c(0.,0.,0.,0,0,0,0,0,0,0,0,
0,0,0,
0,0,0,
0,0,0,0,0,0,
0,0,0,
0,0,0,0,0,0,0),
'classification'=rep(c('4F','top','Yukawa','2 quark Higgs','2 lepton Higgs','Higgs'),times=c(11,3,3,6,3,7))
)
matr <- df[, !colnames(df) %in% c("classification", "lower_bound",'upper_bound','operators','index')]
matr <- matr %>%  as.matrix() %>%t()
colnames(matr) =df$operators
df$mean <- (df$upper_bound+df$lower_bound)/2
pltfunc<-function(index){ ggplot(df, aes(x = index, y = mean)) +
geom_point(size = 1) +
geom_errorbar(aes(ymin = lower_bound, ymax = upper_bound)) #+
#  theme(axis.line.x=element_blank(),
#       axis.text.x=element_blank(),
#      axis.ticks.x=element_blank(),
#     axis.title.x=element_blank(),
#    axis.title.y=element_blank(),
#   panel.grid.minor.x=element_blank(),
#  panel.grid.major.x=element_blank())
}
ha<- HeatmapAnnotation(foo = df$classification,
#bar = cbind(1:10, 10:1),
#gplot = pltfunc,
annotation_name_rot = 45)
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
help(norm)
df$mean <- (df$upper_bound+df$lower_bound)/2-df$upper_bound-df$lower_bound)/2
rnorm(100, mean=df$mean, sd=df$std)
rnorm(100, mean=df$mean[1], sd=df$std[1])
df$std <- (df$upper_bound-df$lower_bound)/zstar/2
df$mean <- (df$upper_bound+df$lower_bound)/2-df$upper_bound-df$lower_bound)/2
rnorm(100, mean=df$mean[1], sd=df$std[1])
rnorm(100, mean=df$mean, sd=df$std)
nrm<-rnorm(100, mean=df$mean, sd=df$std)
nrm
ha<- HeatmapAnnotation(foo = df$classification,
bar = anno_barplot(df$std),
annotation_name_rot = 45)
ha<- HeatmapAnnotation(foo = df$classification,
bar = anno_barplot(nrm),
annotation_name_rot = 45)
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
ha<- HeatmapAnnotation(foo = df$classification,
bar = anno_boxplot(nrm),
annotation_name_rot = 45)
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
nrm<-matrix(rnorm(100, mean=df$mean, sd=df$std))
ha<- HeatmapAnnotation(foo = df$classification,
bar = anno_boxplot(nrm),
annotation_name_rot = 45)
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
nrm=c()
for i in 1:length(df$mean):
x<-rnorm(100, mean=df$mean[i], sd=df$std[i])
nrm<-c(x)
nrm<- nrm %>% as.matrix()
for i in 1:33:
x<-rnorm(100, mean=df$mean[i], sd=df$std[i])
nrm=c()
for( i in 1:33){
x<-rnorm(100, mean=df$mean[i], sd=df$std[i])
nrm<-c(x) }
nrm<- nrm %>% as.matrix()
ha<- HeatmapAnnotation(foo = df$classification,
bar = anno_boxplot(nrm),
annotation_name_rot = 45)
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
nrm=c()
for( i in 1:33){
x<-rnorm(100, mean=df$mean[i], sd=df$std[i])
nrm<-c(x) }
rnm
nrm=c()
for( i in 1:33){
x<-rnorm(100, mean=df$mean[i], sd=df$std[i])
nrm<-c(nrm,x) }
rnm
nrm<- nrm %>% as.matrix()
nrm
ha<- HeatmapAnnotation(foo = df$classification,
bar = anno_boxplot(nrm),
annotation_name_rot = 45)
nrm  <-array(0, dim=c(33,100))
for( i in 1:33){
x<-rnorm(100, mean=df$mean[i], sd=df$std[i])
nrm[i,]<- x
nrm  <-array(0, dim=c(33,100))
for( i in 1:33){
x<-rnorm(100, mean=df$mean[i], sd=df$std[i])
nrm[i,]<- x
}
nrm
nrm
nrm  <-array(0, dim=c(33,100))
for( i in 1:33){
x<-rnorm(100, mean=df$mean[i], sd=df$std[i])
nrm[i,]<- x
}
nrm
nrm<- nrm %>% as.matrix()
ha<- HeatmapAnnotation(foo = df$classification,
bar = anno_boxplot(nrm),
annotation_name_rot = 45)
nrm<- nrm %>% as.matrix() %>% t()
ha<- HeatmapAnnotation(foo = df$classification,
bar = anno_boxplot(nrm),
annotation_name_rot = 45)
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
#ord<-column_order(ht)
#ord
df
nrm  <-array(0, dim=c(100,33))
for( i in 1:33){
x<-rnorm(100, mean=df$mean[i], sd=df$std[i])
nrm[,i]<- x
}
ha<- HeatmapAnnotation(foo = df$classification,
bar = anno_boxplot(nrm),
annotation_name_rot = 45)
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
ht <- draw(ht)
nrm[,33]
std(nrm[,33])
mean(nrm[,33])
nrm  <-array(0, dim=c(500,33))
for( i in 1:33){
x<-rnorm(5000, mean=df$mean[i], sd=df$std[i])
nrm[,i]<- x
}
nrm  <-array(0, dim=c(500,33))
for( i in 1:33){
x<-rnorm(500, mean=df$mean[i], sd=df$std[i])
nrm[,i]<- x
}
mean(nrm[,33])
ha<- HeatmapAnnotation(foo = df$classification,
bar = anno_boxplot(nrm),
annotation_name_rot = 45)
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
ha<- HeatmapAnnotation(foo = df$classification,
bar = anno_points(df$means),
annotation_name_rot = 45)
ha<- HeatmapAnnotation(foo = df$classification,
bar = anno_points(df$mean),
annotation_name_rot = 45)
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
df$mean
anno_boxplot
anno_boxplot
ha<- HeatmapAnnotation(foo = df$classification,
bar = anno_boxplot(nrm),
annotation_name_rot = 45)
ht<- Heatmap(matr,show_column_dend = FALSE,top_annotation = ha)
ht <- draw(ht)
install.packages("ggalluvial")
